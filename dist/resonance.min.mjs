/**
 * resonance@1.0.0 https://github.com/EvitcaStudio/Resonance
 * Compiled 1/9/2024, 10:14:47 AM UTC
 * 
 * resonance is licensed under a MIT styled License. See LICENSE.md for more info.
 * 
 * Copyright 2024, Evitca Studio, All Rights Reserved
 */
 var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={},s=(t.d(e,{P:()=>y}),{d:(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)}),i={},a=(s.d(i,{k:()=>u}),{d:(t,e)=>{for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)}),n={};a.d(n,{Y:()=>r});class r{constructor(t){this.RESET="[0m",this.BRIGHT="[1m",this.DIM="[2m",this.UNDERSCORE="[4m",this.BLINK="[5m",this.REVERSE="[7m",this.HIDDEN="[8m",this.FG_BLACK="[30m",this.FG_RED="[31m",this.FG_GREEN="[32m",this.FG_YELLOW="[33m",this.FG_BLUE="[34m",this.FG_MAGENTA="[35m",this.FG_CYAN="[36m",this.FG_WHITE="[37m",this.FG_GRAY="[90m",this.BG_BLACK="[40m",this.BG_RED="[41m",this.BG_GREEN="[42m",this.BG_YELLOW="[43m",this.BG_BLUE="[44m",this.BG_MAGENTA="[45m",this.BG_CYAN="[46m",this.BG_WHITE="[47m",this.BG_GRAY="[100m",this.TYPE_SPACER_LENGTH=13,this.types={default:this.FG_WHITE},this.currentType="",this.SPACE_CHAR=" ",this.FG_COLORS={};for(let t=0;t<=255;t++)this.FG_COLORS[t]="[38;5;"+t+"m";this.BG_COLORS={};for(let t=0;t<=255;t++)this.BG_COLORS[t]="[48;5;"+t+"m";Array.isArray(t)&&this.registerTypes(t)}prefix(t){return"string"==typeof t&&(this.currentType=t),this}message(e="log",...s){var i=this.currentType||"";if(0===i.length)console[e](...s);else{var a=i.length>=this.TYPE_SPACER_LENGTH;let t=this.types[i.toLowerCase()]?this.types[i.toLowerCase()]:this.types.default;var n=t.includes("");n||(t="color: "+t),!globalThis.window||n?console[e](t+i+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-i.length,a?1:0))+"|"+this.RESET,...s):console[e]("%c"+i+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-i.length,a?1:0))+"|",t,...s)}this.currentType=""}log(...t){this.message("log",...t)}info(...t){this.message("info",...t)}error(...t){this.message("error",...t)}warn(...t){this.message("warn",...t)}assert(...t){console.assert(...t)}debug(...t){this.message("debug",...t)}count(t){console.count(t)}countReset(t){console.countReset(t)}table(t,e){console.table(t,e)}time(t){this.message("time",t)}timeLog(t){this.message("timeLog",t)}timeEnd(t){this.message("timeEnd",t)}trace(...t){this.message("trace",...t)}group(t){this.message("group",t)}groupCollapsed(t){console.groupCollapsed(t)}groupEnd(){console.groupEnd()}clear(){console.clear()}registerType(t,e){this.types[t]||"string"==typeof t&&"string"==typeof e&&(this.types[t.toLowerCase()]=e)}registerTypes(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this.registerType(e[t].type,e[t].ansi)}unregisterType(t){this.types[t]&&delete this.types[t]}}var o=n.Y;class u{constructor({start:t={},end:e={},duration:s=1e3,easing:i=u.linear}={}){this._build(t,e,s,i)}static linear(t,e,s,i){return s*t/i+e}static easeInQuad(t,e,s,i){return s*(t/=i)*t+e}static easeOutQuad(t,e,s,i){return-s*(t/=i)*(t-2)+e}static easeInOutQuad(t,e,s,i){return(t/=i/2)<1?s/2*t*t+e:-s/2*(--t*(t-2)-1)+e}static easeInSine(t,e,s,i){return-s*Math.cos(t/i*(Math.PI/2))+s+e}static easeOutSine(t,e,s,i){return s*Math.sin(t/i*(Math.PI/2))+e}static easeInOutSine(t,e,s,i){return-s/2*(Math.cos(Math.PI*t/i)-1)+e}static easeInExpo(t,e,s,i){return 0==t?e:s*Math.pow(2,10*(t/i-1))+e}static easeOutExpo(t,e,s,i){return t==i?e+s:s*(1-Math.pow(2,-10*t/i))+e}static easeInOutExpo(t,e,s,i){return 0==t?e:t==i?e+s:(t/=i/2)<1?s/2*Math.pow(2,10*(t-1))+e:s/2*(2-Math.pow(2,-10*--t))+e}static easeInCirc(t,e,s,i){return-s*(Math.sqrt(1-(t/=i)*t)-1)+e}static easeOutCirc(t,e,s,i){return s*Math.sqrt(1-(t=t/i-1)*t)+e}static easeInOutCirc(t,e,s,i){return(t/=i/2)<1?-s/2*(Math.sqrt(1-t*t)-1)+e:s/2*(Math.sqrt(1-(t-=2)*t)+1)+e}static easeInCubic(t,e,s,i){return s*(t/=i)*t*t+e}static easeOutCubic(t,e,s,i){return s*((t=t/i-1)*t*t+1)+e}static easeInOutCubic(t,e,s,i){return(t/=i/2)<1?s/2*t*t*t+e:s/2*((t-=2)*t*t+2)+e}static easeInQuart(t,e,s,i){return s*(t/=i)*t*t*t+e}static easeOutQuart(t,e,s,i){return-s*((t=t/i-1)*t*t*t-1)+e}static easeInOutQuart(t,e,s,i){return(t/=i/2)<1?s/2*t*t*t*t+e:-s/2*((t-=2)*t*t*t-2)+e}static easeInQuint(t,e,s,i){return s*(t/=i)*t*t*t*t+e}static easeOutQuint(t,e,s,i){return s*((t=t/i-1)*t*t*t*t+1)+e}static easeInOutQuint(t,e,s,i){return(t/=i/2)<1?s/2*t*t*t*t*t+e:s/2*((t-=2)*t*t*t*t+2)+e}static easeInElastic(t,e,s,i){var a,n=s;return 0==t?e:1==(t/=i)?e+s:(a=.3*i,s=n<Math.abs(s)?(n=s,a/4):0===s&&0===n?a/(2*Math.PI)*Math.asin(1):a/(2*Math.PI)*Math.asin(s/n),-n*Math.pow(2,10*--t)*Math.sin((t*i-s)*(2*Math.PI)/a)+e)}static easeOutElastic(t,e,s,i){var a,n,r=s;return 0==t?e:1==(t/=i)?e+s:(n=.3*i,a=r<Math.abs(s)?(r=s,n/4):0===s&&0===r?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(s/r),r*Math.pow(2,-10*t)*Math.sin((t*i-a)*(2*Math.PI)/n)+s+e)}static easeInOutElastic(t,e,s,i){var a,n,r=s;return 0==t?e:2==(t/=i/2)?e+s:(n=i*(.3*1.5),a=r<Math.abs(s)?(r=s,n/4):0===s&&0===r?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(s/r),t<1?r*Math.pow(2,10*--t)*Math.sin((t*i-a)*(2*Math.PI)/n)*-.5+e:r*Math.pow(2,-10*--t)*Math.sin((t*i-a)*(2*Math.PI)/n)*.5+s+e)}static easeInBack(t,e,s,i){return s*(t/=i)*t*(2.70158*t-1.70158)+e}static easeOutBack(t,e,s,i){return s*((t=t/i-1)*t*(2.70158*t+1.70158)+1)+e}static easeInOutBack(t,e,s,i){var a=1.70158;return(t/=i/2)<1?s/2*(t*t*((1+(a*=1.525))*t-a))+e:s/2*((t-=2)*t*((1+(a*=1.525))*t+a)+2)+e}static easeInBounce(t,e,s,i){return s-this.easeOutBounce(i-t,0,s,i)+e}static easeOutBounce(t,e,s,i){return(t/=i)<1/2.75?7.5625*s*t*t+e:t<2/2.75?s*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?s*(7.5625*(t-=2.25/2.75)*t+.9375)+e:s*(7.5625*(t-=2.625/2.75)*t+.984375)+e}static easeInOutBounce(t,e,s,i){return t<.5*i?.5*this.easeInBounce(2*t,0,s,i)+e:.5*this.easeOutBounce(2*t-i,0,s,i)+.5*s+e}static _clamp(t,e=0,s=1){return Math.max(e,Math.min(t,s))}static _hexToRgb(t){return t=(t=3===(t=t.replace("#","")).length?t.replace(new RegExp("(.)","g"),"$1$1"):t).match(new RegExp("..","g")),[u._clamp(parseInt(t[0],16),0,255),u._clamp(parseInt(t[1],16),0,255),u._clamp(parseInt(t[2],16),0,255)]}static _rgbToHex(t){if(Array.isArray(t))return"#"+t.map(t=>Math.abs(Math.round(t)).toString(16).padStart(2,"0")).join("")}version="1.0.0";_build(t,e,s,i){this.start=t,this.end=e,this.duration=s,this.easing="function"==typeof i?i:u.linear,this.events={},this.exportedValues={},this.tweening=!1,this.update=null,this.paused=!1,this.lastTime=0,this.elapsed=0}build({start:t={},end:e={},duration:s=1e3,easing:i=u.linear}={}){return this._build(t,e,s,i),this}on(t,e){if("function"==typeof e)switch(t){case"start":case"end":case"pause":case"resume":this.events[t]=e;break;default:d.prefix("Tween-Module").error(`The event "${t}" is not supported.`)}else d.prefix("Tween-Module").error(`The callback for event "${t}" is not a function.`);return this}animationFrame=()=>{if(this.tweening&&!this.paused){var i,a,t=Date.now();this.lastTime||(this.lastTime=t),this.elapsed+=t-this.lastTime;let s=this.elapsed/this.duration;for(i in 1<(s=this.oscillating?(1-Math.cos(s*Math.PI))/2:s)&&(s=1),this.end){let t=this.start[i],e=this.end[i];"string"==typeof t&&(3===t.length||6===t.length)||4===t.length||7===t.length?(t=u._hexToRgb(t),e=u._hexToRgb(e),a=[this.easing(s,t[0],e[0]-t[0],1),this.easing(s,t[1],e[1]-t[1],1),this.easing(s,t[2],e[2]-t[2],1)],this.exportedValues[i]=u._rgbToHex(a)):this.exportedValues[i]=this.easing(s,t,e-t,1)}this.update(this.exportedValues),1!==s||this.oscillating?requestAnimationFrame(this.animationFrame):(this.stop(),this.events.end&&this.events.end()),this.lastTime=t}};animate(s,i=!1){if("function"!=typeof s)d.prefix("Tween-Module").error("The pUpdate parameter passed to animate is not a function.");else if(!this.tweening){let t=Object.keys(this.start),e=Object.keys(this.end);if(t.length&&e.length){if(t.every(t=>e.includes(t)))return this.update=s,this.tweening=!0,this.elapsed=0,this.oscillating=i,this.events.start&&this.events.start(),requestAnimationFrame(this.animationFrame),this;d.prefix("Tween-Module").error("The end object is missing properties that the start object has.")}else d.prefix("Tween-Module").error("The start object or the end object has no properties.")}}resume(){return this.paused&&(this.lastTime=Date.now(),this.paused=!1,this.events.resume&&this.events.resume(),requestAnimationFrame(this.animationFrame)),this}pause(){return this.paused||(this.paused=!0,this.events.pause&&this.events.pause()),this}stop(){this.tweening=!1,this.oscillating=!1,this.update=null,this.elapsed=0,this.lastTime=0,this.paused=!1;for(const t in this.exportedValues)this.exportedValues.hasOwnProperty(t)&&delete this.exportedValues[t]}}const d=new o;d.registerType("Tween-Module","#ff6600");var h=i.k;class l{soundPath=null;startTime=null;endTime=null;save=null;duration=null;source=null;gainNode=null;loaded=!1;playAfterLoad=!1;muted=!1;state=null;startedTimeStamp=null;pausedTimeStamp=0;playUnfocused=null;fader={};events={};stopSignal=!1;_loop=!1;_playbackRate=1;_volume=100;_info={soundPath:null,duration:null};constructor(t,e,s,i,a,n,r,o){this.build(t,e,s,i,a,n,r,o)}get volume(){return this._volume}set volume(t){this._volume=y.constructor.clamp(t,y.constructor.MIN_VOLUME,y.constructor.MAX_VOLUME),this.loaded&&(this.gainNode.gain.value=y.constructor.normalize(this._volume))}on(t,e){if("function"==typeof e)switch(t){case"start":case"stop":case"end":case"pause":case"resume":this.events[t]=e;break;default:y.logger.prefix("Resonance-Module").error(`The event "${t}" is not supported.`)}else y.logger.prefix("Resonance-Module").error(`The callback for event "${t}" is not a function.`);return this}toggleMute(){if(this.loaded&&this.source)return this.muted=!this.muted,this.muted?this.gainNode.gain.value=0:this.gainNode.gain.value=y.constructor.normalize(this._volume),this}get loop(){return this._loop}set loop(t){this._loop=!!t,this.source&&(this.source.loop=this._loop)}toggleLoop(){return this._loop=!this._loop,this.source&&(this.source.loop=this._loop),this}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=y.constructor.clamp(t,1,y.constructor.MAX_PLAYBACK_RATE),this.source&&(this.source.playbackRate.value=this._playbackRate)}set info(t){this._info=this._info}get info(){return this.loaded&&this.source&&(this._info.duration=this.duration),this._info.soundPath=this.soundPath,{...this._info}}build(t,e=100,s=0,i=0,a=!1,n=!1,r=1,o=!1){this.soundPath=t,this.startTime=Math.max(s,0),this.endTime=Math.max(i,0),this.save=!!o||a,this._playbackRate=y.constructor.clamp(r,1,y.constructor.MAX_PLAYBACK_RATE),this.playUnfocused=!!n,this.state=null,this._loop=!!o,this._volume=y.constructor.clamp(e,y.constructor.MIN_VOLUME,y.constructor.MAX_VOLUME),y.loadedBuffers[this.soundPath]?this.loaded=!0:this.load()}load(){const e=new XMLHttpRequest,s=this;e.open("GET",s.soundPath),e.responseType="arraybuffer",e.onload=function(){var t=e.response;y.audioCtx.decodeAudioData(t,t=>{s.loaded=!0,y.loadedBuffers[s.soundPath]=t,s.playAfterLoad&&(s.stopSignal?s.stopSignal=!1:s.play())},t=>{s.loaded=!1,y.logger.prefix("Resonance-Module").error(`Error with decoding audio data "${s.soundPath}" This sound has been killed.`),s.kill()})},e.send()}pause(){if(this.loaded)return this.stop("suspended"),this.state="suspended",this.pausedTimeStamp=y.audioCtx.currentTime-this.startedTimeStamp,y.soundsPlaying.includes(this)&&y.soundsPlaying.splice(y.soundsPlaying.indexOf(this),1),y.pausedSounds.includes(this)||y.pausedSounds.push(this),"function"==typeof this.events.pause&&this.events.pause(),this}resume(){if(this.loaded)return y.pausedSounds.includes(this)&&y.pausedSounds.splice(y.pausedSounds.indexOf(this),1),y.soundsPlaying.includes(this)||y.soundsPlaying.push(this),this.play(!0),this.state=this.fader.raf?"fading":"playing","function"==typeof this.events.resume&&this.events.resume(),this}stop(t){var e;if(this.source)return e="playing"===this.state||"fading"===this.state||"suspended"===this.state,y.soundsPlaying.includes(this)&&y.soundsPlaying.splice(y.soundsPlaying.indexOf(this),1),this.source&&(this.source.stop||(this.source.stop=this.source.noteOff),this.source.stop(),this.source.disconnect(),this.gainNode.disconnect(),this.source=null,this.gainNode=null),this.state=t||"stopped","stopped"===this.state&&e&&"function"==typeof this.events.stop&&this.events.stop(),this;this.stopSignal=!0}play(t){if(this.soundPath&&"recycled"!==this.state&&y.canPlaySound())if(this.loaded||y.loadedBuffers[this.soundPath]){if(y.focused||this.canPlayUnfocused()){this.source&&(this.source.disconnect(),this.gainNode.disconnect(),this.source=null,this.gainNode=null),y.pausedSounds.includes(this)&&y.pausedSounds.splice(y.pausedSounds.indexOf(this),1);const e=y.audioCtx.createBufferSource(),s=y.audioCtx.createGain(),i=this;return s.gain.value=y.constructor.normalize(this._volume),s.connect(y.gainNode),e.connect(s),e.buffer=y.loadedBuffers[this.soundPath],e.playbackRate.value=this._playbackRate,e.onended=function(){"stopped"===i.state&&i.save||("restart"!==i.state?"suspended"!==i.state&&("stopped"!==i.state&&"function"==typeof i.events.end&&i.events.end(),i._loop?i.play():i.save||i.kill()):i.play())},this.source=e,this.gainNode=s,this.duration=e.buffer.duration,this.playAfterLoad=null,e.start||(e.start=e.noteOn),e.start(0,this.pausedTimeStamp?this.pausedTimeStamp*this._playbackRate:this.startTime,this.endTime||this.duration),this.state="playing",this.startedTimeStamp=y.audioCtx.currentTime-(this.pausedTimeStamp||this.startTime),this.pausedTimeStamp=0,y.soundsPlaying.includes(this)||y.soundsPlaying.push(this),t||"function"!=typeof this.events.start||this.events.start(),this}y.queuedSoundsToPlay.includes(this)||y.queuedSoundsToPlay.push(this)}else this.playAfterLoad=!0}restart(){return this.stop("restart"),this}canPlayUnfocused(){return!!this.playUnfocused}kill(){if(this.wipe(),y.recycledSounds.length<y.constructor.MAX_RECYCLED_SOUNDS)y.recycledSounds.push(this);else for(const t in this)delete this[t]}wipe(){this.onStarted=null,this.onStopped=null,this.onEnded=null,this.onSuspended=null,this.onResumed=null,this.stop("wipe"),cancelAnimationFrame(this.fader.raf),this.source&&(this.source.disconnect(),this.gainNode.disconnect()),this.soundPath=null,this.startTime=null,this.endTime=null,this.save=null,this.duration=null,this._playbackRate=1,this.source=null,this.gainNode=null,this.loaded=!1,this.playAfterLoad=null,this.state="recycled",this.startedTimeStamp=null,this.pausedTimeStamp=0,this.playUnfocused=null,this.fader.duration=this.fader.currentIteration=this.fader.initialValue=this.fader.changeInValue=this.fader.totalIterations=this.fader.startStamp=this.fader.previousTimeStamp=this.fader.durationOffScreen=this.fader.queue=this.fader.raf=null,this.stopSignal=!1,this._loop=!1,this._volume=100,this._info.soundPath=this._info.duration=null;for(const t in this.events)delete this.events[t];y.soundsPlaying.includes(this)&&y.soundsPlaying.splice(y.soundsPlaying.indexOf(this),1),y.pausedSounds.includes(this)&&y.pausedSounds.splice(y.pausedSounds.indexOf(this),1),y.queuedSoundsToPlay.includes(this)&&y.queuedSoundsToPlay.splice(y.queuedSoundsToPlay.indexOf(this),1),y.queuedSoundsToFade.includes(this)&&y.queuedSoundsToFade.splice(y.queuedSoundsToFade.indexOf(this),1)}getCurrentTime(){return this.pausedTimeStamp?this.pausedTimeStamp*this._playbackRate:this.startedTimeStamp?y.audioCtx.currentTime-this.startedTimeStamp:0}fade(s=100,t=5e3,i="easeOutCubic",a){if(!isNaN(s)&&!(isNaN(t)||"playing"!==this.state&&y.focused)){if(!y.focused&&!this.canPlayUnfocused())return y.queuedSoundsToFade.includes(this)?void 0:(this.fader.queue={volume:s,duration:t,ease:i,callback:a},void y.queuedSoundsToFade.push(this));Tween[i]||(i="easeOutCubic",y.logger.prefix("Resonance-Module").warn("Resonance: Invalid pEase value. Reverted to default.")),this.fader.queue&&(this.fader.queue=null),s=y.constructor.clamp(s,y.constructor.MIN_VOLUME,y.constructor.MAX_VOLUME),this.fader.duration=Math.max(t,0),this.fader.currentIteration=0,this.fader.initialValue=this._volume,this.fader.changeInValue=s-this.fader.initialValue,this.fader.totalIterations=this.fader.duration/(1e3/y.constructor.FRAME_RATE),this.fader.startStamp=null,this.fader.previousTimeStamp=null,this.fader.durationOffScreen=[0,0],this.state="fading";const n=this,r=function(t){var e;y.focused?(null===n.fader.startStamp&&(n.fader.startStamp=t),n.volume=Tween[i](n.fader.currentIteration,n.fader.initialValue,n.fader.changeInValue,n.fader.totalIterations),n.fader.durationOffScreen[1]&&(n.fader.durationOffScreen[0]+=n.fader.durationOffScreen[1],n.fader.durationOffScreen[1]=0),e=t-n.fader.durationOffScreen[0]-n.fader.startStamp,n.fader.currentIteration<n.fader.totalIterations&&n.fader.currentIteration++,e<n.fader.duration?(n.fader.previousTimeStamp=t,n.fader.raf=requestAnimationFrame(r)):(cancelAnimationFrame(n.fader.raf),n.fader.duration=n.fader.currentIteration=n.fader.initialValue=n.fader.changeInValue=n.fader.totalIterations=n.fader.startStamp=n.fader.previousTimeStamp=n.fader.durationOffScreen=n.fader.queue=n.fader.raf=null,n.state="playing",n.volume=s,"function"==typeof a&&a())):(n.fader.raf=requestAnimationFrame(r),n.fader.durationOffScreen[1]=t-n.fader.previousTimeStamp)};return this.fader.raf=requestAnimationFrame(r),this}}queuedFade(){this.fader.queue&&this.fade(this.fader.queue.volume,this.fader.queue.duration,this.fader.queue.ease,this.fader.queue.callback)}}var c={d:(t,e)=>{for(var s in e)c.o(e,s)&&!c.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},p={};c.d(p,{Y:()=>f});class f{constructor(t){this.RESET="[0m",this.BRIGHT="[1m",this.DIM="[2m",this.UNDERSCORE="[4m",this.BLINK="[5m",this.REVERSE="[7m",this.HIDDEN="[8m",this.FG_BLACK="[30m",this.FG_RED="[31m",this.FG_GREEN="[32m",this.FG_YELLOW="[33m",this.FG_BLUE="[34m",this.FG_MAGENTA="[35m",this.FG_CYAN="[36m",this.FG_WHITE="[37m",this.FG_GRAY="[90m",this.BG_BLACK="[40m",this.BG_RED="[41m",this.BG_GREEN="[42m",this.BG_YELLOW="[43m",this.BG_BLUE="[44m",this.BG_MAGENTA="[45m",this.BG_CYAN="[46m",this.BG_WHITE="[47m",this.BG_GRAY="[100m",this.TYPE_SPACER_LENGTH=13,this.types={default:this.FG_WHITE},this.currentType="",this.SPACE_CHAR=" ",this.FG_COLORS={};for(let t=0;t<=255;t++)this.FG_COLORS[t]="[38;5;"+t+"m";this.BG_COLORS={};for(let t=0;t<=255;t++)this.BG_COLORS[t]="[48;5;"+t+"m";Array.isArray(t)&&this.registerTypes(t)}prefix(t){return"string"==typeof t&&(this.currentType=t),this}message(e="log",...s){var i=this.currentType||"";if(0===i.length)console[e](...s);else{var a=i.length>=this.TYPE_SPACER_LENGTH;let t=this.types[i.toLowerCase()]?this.types[i.toLowerCase()]:this.types.default;var n=t.includes("");n||(t="color: "+t),!globalThis.window||n?console[e](t+i+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-i.length,a?1:0))+"|"+this.RESET,...s):console[e]("%c"+i+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-i.length,a?1:0))+"|",t,...s)}this.currentType=""}log(...t){this.message("log",...t)}info(...t){this.message("info",...t)}error(...t){this.message("error",...t)}warn(...t){this.message("warn",...t)}assert(...t){console.assert(...t)}debug(...t){this.message("debug",...t)}count(t){console.count(t)}countReset(t){console.countReset(t)}table(t,e){console.table(t,e)}time(t){this.message("time",t)}timeLog(t){this.message("timeLog",t)}timeEnd(t){this.message("timeEnd",t)}trace(...t){this.message("trace",...t)}group(t){this.message("group",t)}groupCollapsed(t){console.groupCollapsed(t)}groupEnd(){console.groupEnd()}clear(){console.clear()}registerType(t,e){this.types[t]||"string"==typeof t&&"string"==typeof e&&(this.types[t.toLowerCase()]=e)}registerTypes(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this.registerType(e[t].type,e[t].ansi)}unregisterType(t){this.types[t]&&delete this.types[t]}}var m=p.Y;class g{static MAX_VOLUME=200;static MIN_VOLUME=-200;static MAX_RECYCLED_SOUNDS=500;static MAX_PLAYBACK_RATE=10;static FRAME_RATE=60;static clamp=(t,e,s)=>Math.max(e,Math.min(t,s));static normalize=(t,e=0,s=100,i=1)=>(t-e)/(s-e)*i;version="1.0.0";constructor(){window.AudioContext||window.webkitAudioContext?(this.logger=new m,this.logger.registerType("Resonance-Module","#ff6600"),window.AudioContext=window.AudioContext||window.webkitAudioContext,window.addEventListener("mousedown",this.resumeAudioCtx.bind(this)),window.addEventListener("touchstart",this.resumeAudioCtx.bind(this)),window.addEventListener("load",this.resumeAudioCtx.bind(this)),window.addEventListener("blur",()=>{this.focused=!1,this.soundsPlaying.length&&this.pauseAllSounds(!0)}),window.addEventListener("focus",()=>{this.focused=!0,this.pausedSounds.length&&this.resumeAllSounds(!0),(this.queuedSoundsToPlay.length||this.queuedSoundsToFade.length)&&this.playQueuedSounds()}),this.audioCtx=new AudioContext,!this.audioCtx.createGain&&this.audioCtx.createGainNode&&(this.audioCtx.createGain=this.audioCtx.createGainNode),this.gainNode=this.audioCtx.createGain(),this.gainNode.gain.value=g.normalize(g.MAX_VOLUME),this.gainNode.connect(this.audioCtx.destination),this.soundsPlaying=[],this.pausedSounds=[],this.recycledSounds=[],this.queuedSoundsToPlay=[],this.queuedSoundsToFade=[],this.loadedBuffers={},this.fader={},this.volume=100,this.muted=!1,this.state=null,this.focused=!0,this.abilityToPlaySound=null):this.logger.prefix("Resonance-Module").error("Your device does not support window.AudioContext || window.webkitAudioContext. This library cannot be used")}canPlaySound(){return!(this.abilityToPlaySound&&!this.abilityToPlaySound())}enableChecker(t){return"function"==typeof t&&(this.abilityToPlaySound=t),this}adjustVolume(t){return this.volume=g.clamp(t,g.MIN_VOLUME,g.MAX_VOLUME),this.gainNode.gain.value=g.normalize(this.volume),this}fade(s=100,t=5e3,i="easeOutCubic",a){if(!isNaN(s)&&!isNaN(t)&&"fading"!==this.state){s=g.clamp(s,g.MIN_VOLUME,g.MAX_VOLUME),h[i]||this.logger.prefix("Resonance-Module").error("Invalid pEase value. Reverted to default."),this.state="fading",this.fader.duration=Math.max(t,0),this.fader.currentIteration=0,this.fader.initialValue=this.volume,this.fader.changeInValue=s-this.fader.initialValue,this.fader.totalIterations=this.fader.duration/(1e3/g.FRAME_RATE),this.fader.startStamp=null,this.fader.previousTimeStamp=null,this.fader.durationOffScreen=[0,0];const n=this,r=function(t){var e;n.focused?(null===n.fader.startStamp&&(n.fader.startStamp=t),n.adjustVolume(h[i](n.fader.currentIteration,n.fader.initialValue,n.fader.changeInValue,n.fader.totalIterations)),n.fader.durationOffScreen[1]&&(n.fader.durationOffScreen[0]+=n.fader.durationOffScreen[1],n.fader.durationOffScreen[1]=0),e=t-n.fader.durationOffScreen[0]-n.fader.startStamp,n.fader.currentIteration<n.fader.totalIterations&&n.fader.currentIteration++,e<n.fader.duration?(n.fader.previousTimeStamp=t,n.fader.raf=requestAnimationFrame(r)):(cancelAnimationFrame(n.fader.raf),n.fader.duration=n.fader.currentIteration=n.fader.initialValue=n.fader.changeInValue=n.fader.totalIterations=n.fader.startStamp=n.fader.previousTimeStamp=n.fader.durationOffScreen=n.fader.raf=null,n.state=null,n.adjustVolume(s),"function"==typeof a&&a())):(n.fader.raf=requestAnimationFrame(r),n.fader.durationOffScreen[1]=t-n.fader.previousTimeStamp)};return this.fader.raf=requestAnimationFrame(r),this}}toggleMute(){return this.muted=!this.muted,this.muted?(this._previousGainNodeValue=this.gainNode.gain.value,this.gainNode.gain.value=0):this.gainNode.gain.value=this._previousGainNodeValue||1,this}isMuted(){return this.muted}emit(e,s=100,i=0,a,n=1){if(this.canPlaySound()){const r=this,o=r.audioCtx.createBufferSource(),u=(o.kill=function(){this.buffer?this.stop():this.queuedToStop=!0},function(){var t=r.audioCtx.createGain();t.gain.value=g.normalize(g.clamp(s,g.MIN_VOLUME,g.MAX_VOLUME)),t.connect(r.gainNode),o.connect(t),o.buffer=r.loadedBuffers[e],o.playbackRate.value=n,o.start||(o.start=o.noteOn),o.start(0,i,a||o.buffer.duration)});if(this.loadedBuffers[e])u();else{const s=new XMLHttpRequest;s.open("GET",e),s.responseType="arraybuffer",s.onload=function(){var t=s.response;r.audioCtx.decodeAudioData(t,t=>{r.loadedBuffers[e]=t,o.queuedToStop||u()},t=>{this.logger.prefix("Resonance-Module").error(`Error with decoding audio data "${e}"`)})},s.send()}return o}}createSound(t,e,s,i,a,n,r,o){var u;return this.recycledSounds.length?((u=this.recycledSounds.pop()).build(t,e,s,i,a,n,r,o),u):new l(t,e,s,i,a,n,r,o)}stopAllSounds(e){for(let t=this.soundsPlaying.length-1;0<=t;t--){var s=this.soundsPlaying[t];Array.isArray(e)&&e.includes(s)||s.stop()}return this}killAllSounds(){for(let t=this.soundsPlaying.length-1;0<=t;t--)this.soundsPlaying[t].kill();return this}pauseAllSounds(e){for(let t=this.soundsPlaying.length-1;0<=t;t--){var s=this.soundsPlaying[t];e&&s.canPlayUnfocused()||s.pause()}return this}resumeAllSounds(t){for(let t=this.pausedSounds.length-1;0<=t;t--)this.pausedSounds[t].resume();return this}playQueuedSounds(){for(let t=this.queuedSoundsToPlay.length-1;0<=t;t--){var e=this.queuedSoundsToPlay[t];this.queuedSoundsToPlay.splice(t,1),e.play()}for(let t=this.queuedSoundsToFade.length-1;0<=t;t--){var s=this.queuedSoundsToFade[t];this.queuedSoundsToFade.splice(t,1),s.queuedFade()}}unloadSound(t){return this.loadedBuffers[t]&&delete this.loadedBuffers[t],this}recycleSound(t){return t instanceof l&&t.kill(),this}resumeAudioCtx(){"running"!==this.audioCtx.state&&this.audioCtx.resume().then(()=>{},()=>{}),this.ready=!0}}const y=new g;var S=e.P;export{S as Resonance};